{
    email tech@stev.lol

    acme_ca https://step-ca.lofi:9000/acme/acme/directory
    # acme_ca_root /step-ca-data/certs/root_ca.crt

	metrics {
		per_host
	}

}

grafana.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -Server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    reverse_proxy 10.0.0.2:3000 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }
}

prometheus.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -Server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    reverse_proxy 10.0.0.2:9090 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }
}

llm.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -Server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    reverse_proxy 10.0.0.4:11434 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }
}


chat.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -Server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    reverse_proxy 10.0.0.4:3000 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }
}

pgadmin.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    reverse_proxy 10.0.0.2:5433 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }

}

traggo.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    reverse_proxy 10.0.0.2:3030 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }

}


pgadmin.staging.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    reverse_proxy 10.0.0.32:5433 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }

}

auth.staging.lofi {
    @cors_preflight method OPTIONS
    @cors_origin {
        header Origin https://sketches.staging.lofi
        header Origin https://dial-in.staging.lofi
      }

    handle @cors_preflight {
        header Access-Control-Allow-Origin {http.request.header.Origin}
        header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
        header Access-Control-Allow-Headers "Authorization, Content-Type, Origin, Accept"
        header Access-Control-Allow-Credentials "true"
        header Access-Control-Max-Age "1728000"
        respond "" 204
    }

    header @cors_origin Access-Control-Allow-Origin {http.request.header.Origin}
    header @cors_origin Access-Control-Allow-Credentials "true"
    header {
        X-Content-Type-Options "nosniff"
        Referrer-Policy "strict-origin-when-cross-origin"
        -Server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    # staging-web
    reverse_proxy 10.0.0.31:3000 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }
  }

sketches.staging.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    # staging-web
    reverse_proxy 10.0.0.31:3001 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }
  }

dial-in.staging.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    # staging-web
    reverse_proxy 10.0.0.31:3002 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }
  }

streetfortress.staging.lofi {
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Referrer policy
        Referrer-Policy "strict-origin-when-cross-origin"
        # Remove server header for security
        -server
    }
    encode gzip zstd

    log {
        output stdout
        format json
    }

    # staging-web
    reverse_proxy 10.0.0.31:3003 {
        # Timeouts
        transport http {
            dial_timeout 5s
            response_header_timeout 10s
        }

        # Pass real client IP
        header_up X-Real-IP {remote_host}
    }
  }
